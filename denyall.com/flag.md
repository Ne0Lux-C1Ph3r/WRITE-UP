Challenge: denyall.com for ticket NDH2017
----------------------------------------
Category: Cryptography 
----------------------------------------
O point just ticket !!! 
----------------------------------------

```
Description:

Bienvenue au défi NDH 2017.

```

Vous trouvez une carte de visite de quelqu’un travaillant chez DenyAll, un éditeur de logiciel merveilleux qui fournit des solutions de sécurité web à l’état de l’art. Cela à l’air prometteur…

<img src="./files/1.jpg">

Heureusement, vous connaissez un des experts en sécurité qui travaille chez DenyAll. Vous faites une visite des locaux et gardez les yeux bien ouverts.

<img src="./files/2.jpg">

Vous tombez nez à nez avec la salle de réunion Connect. Tiens tiens, ne serait-ce pas l’inscription de la carte de visite ?

<img src="./files/3.jpg">

<img src="./files/4.jpg">

Vous entrez dans la salle et vous trouvez des boulettes de papier jetées dans la poubelle…

<img src="./files/5.jpg">

La curiosité est un vilain défaut, pourtant vous ouvrez les boulettes de papier. Vous tombez sur les messages suivants :

<img src="./files/6.jpg">

Retranscription des boulettes de papier :

```
-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEAi7Vu8sgt6KMJfy1AmDZi9OAL/UU25stZHzE40h5lJwN/gN86
4DQpn90tlZgdPfQGhRFysBPQYxViHDA139nqQAdAwXdZDTQ5rblWqo7NLc8V7G9h
FfUJj3C/vZrij9pygwjtnt193gKJZS/bAs6JvI2XBhUGLo+f6u8/rTN5z6cncTU8
b2ULktx9JBylYshp372ak/qPfYEE4PvKzEWXSfv6s+HClQD+BXv2g3qbrM+N9IP3
GWMh5gLDRkTuzu7jb2XuQDl3blphuoOUZU1sTP8IYIvifYmMHb7dIJnqOuc9zbGD
CcxmmxEMAuEOfAtL52Se4le9oTf0Ae5wOKvJFQIDAQABAoIBAB5p6fRKZcweKgQY
mtZICLTcTV/egHwvyoAC3CbJ3SVoGoq4jf2e/WzC3piRW9RP2ld/m+L+/T+EuS3/
xMqtitRTf+JeE/HO67uI/Hf2zG3rhg9Jk+4OwP0MA4HIRQgh+wnRmMEb4LnC/Zwc
leX/hnaYsEbvrr/WHm8rlEYlTaBJpYTkeOv9svCkiM2K9vB9jlZNOqK1zrvdQncX
ciFJfRvXg6dxRUp9NWaLwrbJoAbUeYpm0V3NEQ+fewQ4so4N35AkadkXmTyMROyM
XrsADtqQZYqGQQ0r9nc/mjWobFWH1xa/zLZthwgO1Czg+VdAvg0rGVxgpVcxQAQc
qO6ou+UCgYEA0WO8gY6CO3o6J1Vf2gPGoEGydnrwdRCs3IWRNcaKvlBJub3iHZMN
tcat/nWMwS5F7rm5GY+hfh8NxGOI9kCXAb2rmtF1Grz9EFEeB/+mj55eo+pBHg7l
LDlcU3XMWILRIMvn//S1/I7X3JDW1snIKg/GFwcipEt6IYobmevZS88CgYEAqs7d
6rCI+JIVz8SoS1YGvjnNCicQNsggG0m1K1cFUu5z1lv9qFlzq4NhuqRTU81aup0Z
Nf0NuQKJpWghpJEiga2jG3CbcerYsGhsJYnLN9wgdA5wUA+YV0scOhVEtthT5k36
LzpxDn1OTPfAks80ID80VN7HLp5rh4wkNcop4dsCgYEAkFSFPXBzyHep2i75ERgF
M7XVQ+HeGXNTE/Zlb4HZZPGGwCdo0yXoD2JR0NJKIWa6AaG3Oy1MDdlt7e8GG2fO
Lv8EaIT0iWe3sCWZ472Om/R4G9h+5i8yPNeVElpibqhNaqPi2QVe5CW6GWklDYyt
EoEo8/qRIFp+ZtwBxolRkPUCgYApLeZihlz/UHjhtk+8mejWQ6kjIXfPPUBAU+zR
nhEyhTp4G4Vz6NzyJKKTFLriIUgWZXmGgpOkXvBAaHJz8mmXSf1gyC0xsaS8IvCv
vCC6Pt+0GycIpjncEcekWSxPyKexhmsip7xJ+fu+opxSyJGQlKxRKcRrgNX7v9Wb
AjpGsQKBgCQrUeyhwPSskY3kAyozzf/Z2+nyBpaGT7uM5qGYJqj1MMWzZiSdAadw
s/HoaDCiujJzuzQ6WooEtM7CNFtCwvla0lzS9NAFazNR1t0QyO/OeNbDcnVRwk73
3FmprVLqH2uWjqaIMPp1NnYJdkBstB2/splQlH6OdyNA4Jvd3JFC
-----END RSA PRIVATE KEY-----
```

Message chiffré

```
527a6456656d6c56616e5a6a63555634643064485a6a56754d33493353454e714d6e4e6c5155773065486c706333673256573973656a527763454e4a56334a69517a6c4a61464675654651780a534649726145524a516a457a56555a36644570596332783257445232576c6c694c32497754326779576c6c474f4751774f57397a4d336f76536d4a46515749795130747252586c704f46684a0a5a464172596a46355446564c4e55354a654534334e5549726258677652566b33535446764e5856525557394359314a765531686b616c6870637a4135656b73336343394b527a6379534646430a5747564757465a69646b39584b314252576b6b34593342785a54527552445a7565574535655642324d6d466155304576534770494e6a56435a6a6b72595868495a315653536d3945616c49770a5a6a524e65466376646e464e4f4642554e6b7372593051316154423162554e5962556c6e556c4d795a5756724e7939354d477451626d6872576d6c79574770524f5535315a586c46535852730a6569387756475677567a5a35616d6f72536e4e5457575a69515531764f4570684d6b4e3056325132595468744c30394b564574614f4842364d314269556d465364323430646a4670656e4e420a5054303d
```

Il s’agit d’un message chiffré qui contient sûrement des indications pour obtenir une place à la Nuit du Hack. Avec vos yeux d’expert en cryptographie, vous vous apercevez que le message a été chiffré de la façon suivante :

    Chiffrement RSA en 2048 bits
    Double encodage Base64
    Encodage Hexadecimal

Facile ! Soyez un des 5 premiers à déchiffrer et décoder le message pour obtenir une entrée à la Nuit du Hack.


``` python
#!/usr/bin/env python

from binascii import unhexlify, b2a_base64
import base64

# Decodage HEX to base64
hex = '527a6456656d6c56616e5a6a63555634643064485a6a56754d33493353454e714d6e4e6c5155773065486c706333673256573973656a527763454e4a56334a69517a6c4a61464675654651780a534649726145524a516a457a56555a36644570596332783257445232576c6c694c32497754326779576c6c474f4751774f57397a4d336f76536d4a46515749795130747252586c704f46684a0a5a464172596a46355446564c4e55354a654534334e5549726258677652566b33535446764e5856525557394359314a765531686b616c6870637a4135656b73336343394b527a6379534646430a5747564757465a69646b39584b314252576b6b34593342785a54527552445a7565574535655642324d6d466155304576534770494e6a56435a6a6b72595868495a315653536d3945616c49770a5a6a524e65466376646e464e4f4642554e6b7372593051316154423162554e5962556c6e556c4d795a5756724e7939354d477451626d6872576d6c79574770524f5535315a586c46535852730a6569387756475677567a5a35616d6f72536e4e5457575a69515531764f4570684d6b4e3056325132595468744c30394b564574614f4842364d314269556d465364323430646a4670656e4e420a5054303d'
result = hex.decode('hex').encode('base64')
print result
# Decodage base64
result2 = base64.b64decode(result)
print result2
# Decodage du double encodage base64
flag = base64.b64decode(result2)
print flag


def decrypt_FLAG(privkey, message):
    from Crypto.PublicKey import RSA  
    from base64 import b64decode 
    key = open(privkey, "r").read() 
    rsakey = RSA.importKey(key) 
    decrypted = rsakey.decrypt(b64decode(message))
    return decrypted

print decrypt_FLAG('private.key', flag)

# flag ===> http://info.denyall.com/NDH2017_Registration-Page-FR.html
```

