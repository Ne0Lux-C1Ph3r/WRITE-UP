#!/usr/bin/env python

from binascii import unhexlify, b2a_base64
import base64

# Decodage HEX to base64
hex = '527a6456656d6c56616e5a6a63555634643064485a6a56754d33493353454e714d6e4e6c5155773065486c706333673256573973656a527763454e4a56334a69517a6c4a61464675654651780a534649726145524a516a457a56555a36644570596332783257445232576c6c694c32497754326779576c6c474f4751774f57397a4d336f76536d4a46515749795130747252586c704f46684a0a5a464172596a46355446564c4e55354a654534334e5549726258677652566b33535446764e5856525557394359314a765531686b616c6870637a4135656b73336343394b527a6379534646430a5747564757465a69646b39584b314252576b6b34593342785a54527552445a7565574535655642324d6d466155304576534770494e6a56435a6a6b72595868495a315653536d3945616c49770a5a6a524e65466376646e464e4f4642554e6b7372593051316154423162554e5962556c6e556c4d795a5756724e7939354d477451626d6872576d6c79574770524f5535315a586c46535852730a6569387756475677567a5a35616d6f72536e4e5457575a69515531764f4570684d6b4e3056325132595468744c30394b564574614f4842364d314269556d465364323430646a4670656e4e420a5054303d'
result = hex.decode('hex').encode('base64')
print result
# Decodage base64
result2 = base64.b64decode(result)
print result2
# Decodage du double encodage base64
flag = base64.b64decode(result2)
print flag


def decrypt_FLAG(privkey, message):
    from Crypto.PublicKey import RSA  
    from base64 import b64decode 
    key = open(privkey, "r").read() 
    rsakey = RSA.importKey(key) 
    decrypted = rsakey.decrypt(b64decode(message))
    return decrypted

print decrypt_FLAG('private.key', flag)

# flag ===> http://info.denyall.com/NDH2017_Registration-Page-FR.html